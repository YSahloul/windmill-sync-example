summary: Back-Office of an E-Commerce Business
value:
  css:
    aggridcomponent: {}
    app:
      component:
        class: ''
        style: ''
      grid:
        class: ''
        style: ''
      viewer:
        class: ''
        style: ''
    barchartcomponent:
      container:
        class: ''
        style: ''
    buttoncomponent:
      button:
        class: ''
        style: ''
    checkboxcomponent:
      text:
        class: ''
        style: ''
    containercomponent:
      container:
        class: ''
        style: ''
    currencycomponent:
      input:
        class: ''
        style: ''
    dateinputcomponent:
      input:
        class: ''
        style: ''
    displaycomponent:
      container:
        class: ''
        style: ''
      header:
        class: ''
        style: ''
    drawercomponent: {}
    fileinputcomponent:
      container:
        class: ''
        style: ''
    formbuttoncomponent:
      button:
        class: ''
        style: ''
      popup:
        class: ''
        style: ''
    formcomponent:
      button:
        class: ''
        style: ''
      container:
        class: ''
        style: ''
    horizontaldividercomponent:
      container:
        class: ''
        style: ''
      divider:
        class: ''
        style: ''
    horizontalsplitpanescomponent:
      container:
        class: ''
        style: ''
    htmlcomponent:
      container:
        class: ''
        style: ''
    iconcomponent:
      container:
        class: ''
        style: ''
      icon:
        class: ''
        style: ''
    imagecomponent:
      image:
        class: ''
        style: ''
    mapcomponent:
      map:
        class: ''
        style: ''
    multiselectcomponent:
      input:
        style: ''
    numberinputcomponent:
      input:
        class: ''
        style: ''
    passwordinputcomponent:
      input:
        class: ''
        style: ''
    piechartcomponent:
      container:
        class: ''
        style: ''
    plotlycomponent: {}
    rangecomponent:
      handles:
        style: ''
      limits:
        class: ''
        style: ''
      values:
        class: ''
        style: ''
    scatterchartcomponent:
      container:
        class: ''
        style: ''
    selectcomponent:
      input:
        style: ''
    slidercomponent:
      value:
        class: ''
        style: ''
      handle:
        style: ''
      limits:
        class: ''
        style: ''
    tablecomponent:
      container:
        class: ''
        style: ''
      tableBody:
        class: ''
        style: ''
      tableFooter:
        class: ''
        style: ''
      tableHeader:
        class: ''
        style: ''
    tabscomponent:
      allTabs:
        class: ''
        style: ''
      container:
        class: ''
        style: ''
      selectedTab:
        class: ''
        style: ''
      tabRow:
        class: ''
        style: ''
    textcomponent:
      text:
        class: ''
        style: ''
    textinputcomponent:
      input:
        class: ''
        style: ''
    timeseriescomponent:
      container:
        class: ''
        style: ''
    vegalitecomponent: {}
    verticaldividercomponent:
      container:
        class: ''
        style: ''
      divider:
        class: ''
        style: ''
    verticalsplitpanescomponent:
      container:
        class: ''
        style: ''
  fullscreen: true
  grid:
    - '12':
        fixed: false
        h: 1
        id: c
        w: 12
        x: 0
        y: 0
      '3':
        fixed: false
        h: 1
        w: 1
        x: 0
        y: 8
      data:
        componentInput:
          value: 'Hello ${ctx.username}'
          eval: >-
            Note: all editing actions have been disabled in the present example
            as they would affect parent database.
          fieldType: template
          type: template
        configuration:
          copyButton:
            value: false
            type: static
          style:
            value: Body
            type: static
          tooltip:
            value: ''
            type: static
        customCss:
          text:
            class: ''
            style: 'color: #177cc8;'
        horizontalAlignment: left
        id: c
        type: textcomponent
        verticalAlignment: top
      id: c
    - '12':
        fixed: false
        h: 1
        id: f
        w: 12
        x: 0
        y: 1
      '3':
        fixed: false
        h: 1
        w: 1
        x: 1
        y: 8
      data:
        componentInput:
          value: 'Hello ${ctx.username}'
          eval: 'Tutorial: https://docs.windmill.dev/docs/apps/app_e-commerce'
          fieldType: template
          type: template
        configuration:
          copyButton:
            value: false
            type: static
          style:
            value: Body
            type: static
          tooltip:
            value: ''
            type: static
        customCss:
          text:
            class: ''
            style: ''
        horizontalAlignment: left
        id: f
        type: textcomponent
        verticalAlignment: top
      id: f
    - '12':
        customDragger: false
        customResizer: false
        draggable: true
        fixed: true
        h: 22
        id: a
        max:
          h: 100
          w: 12
        min:
          h: 1
          w: 1
        resizable: true
        w: 12
        x: 0
        y: 2
      '3':
        customDragger: false
        customResizer: false
        draggable: true
        fixed: true
        h: 8
        max:
          h: 100
          w: 3
        min:
          h: 1
          w: 1
        resizable: true
        w: 2
        x: 0
        y: 0
      data:
        card: false
        configuration:
          noPadding:
            value: true
            fieldType: boolean
            onlyStatic: true
            type: static
          tabsKind:
            value: null
            type: static
        customCss:
          allTabs:
            class: ''
            style: ''
          container:
            class: ''
            style: ''
          selectedTab:
            class: ''
            style: ''
          tabRow:
            class: ''
            style: ''
        id: a
        numberOfSubgrids: 4
        softWrap: true
        tabs:
          - Products
          - Orders
          - Users
          - Manuel order
        type: tabscomponent
      id: a
  hiddenInlineScripts:
    - name: loadProducts
      autoRefresh: true
      fields:
        auth:
          value: '$res:f/examples/demo_supabase'
          fieldType: object
          format: resource-supabase
          type: static
        columns:
          value: null
          fieldType: string
          type: static
        count:
          value: null
          fieldType: string
          type: static
        filter:
          value: null
          fieldType: object
          type: static
        head:
          value: null
          fieldType: boolean
          type: static
        limit:
          value: null
          fieldType: object
          type: static
        order:
          value: null
          fieldType: object
          type: static
        table:
          value: products
          fieldType: string
          type: static
      inlineScript:
        content: >
          import { Resource } from
          "https://deno.land/x/windmill@v1.70.1/mod.ts";

          import { createClient } from "https://esm.sh/@supabase/supabase-js@2";


          /**
           * @param count Count algorithm to use to count rows in the table or view.
           * `"exact"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the hood.
           * `"planned"`: Approximated but fast count algorithm. Uses the Postgres statistics under the hood.
           * `"estimated"`: Uses exact count for low numbers and planned count for high numbers.
           *
           * @param head When set to `true`, `data` will not be returned.
           * Useful if you only need the count.
           * 
           * @param filter Learn more at https://supabase.com/docs/reference/javascript/filter
           * 
           * @param order Learn more at https://supabase.com/docs/reference/javascript/order
           * 
           * @param limit Learn more at https://supabase.com/docs/reference/javascript/limit
           */
          export async function main(
            auth: Resource<"supabase">,
            table: string,
            columns?: string,
            count?: "exact" | "planned" | "estimated",
            head?: boolean,
            filter?: {
              column: string;
              operator: string;
              value: any;
            },
            order?: {
              column: string;
              foreignTable: string;
              ascending?: boolean;
              nullsFirst?: boolean;
            },
            limit?: {
              count: number;
              foreignTable?: string;
            },
          ) {
            const client = createClient(auth.url, auth.key);
            const options = (head || count) ? { head, count } : undefined;
            let query = client.from(table).select(columns || undefined, options);
            if (filter?.column) {
              query = query.filter(filter.column, filter.operator, filter.value);
            }
            if (order?.column) {
              const { column, ...options } = order;
              query = query.order(column, options);
            }
            if (limit?.count) {
              const { count, foreignTable } = limit;
              query = query.limit(count, foreignTable ? { foreignTable } : undefined);
            }

            return await query;
          }
        language: deno
        path: /loadProducts
        schema:
          $schema: 'https://json-schema.org/draft/2020-12/schema'
          properties:
            auth:
              description: ''
              default: null
              format: resource-supabase
              type: object
            columns:
              description: ''
              default: null
              type: string
            count:
              description: ''
              default: null
              enum:
                - exact
                - planned
                - estimated
              type: string
            filter:
              description: ''
              default: null
              properties:
                value:
                  description: ''
                  type: object
                column:
                  description: ''
                  type: string
                operator:
                  description: ''
                  type: string
              type: object
            head:
              description: ''
              default: null
              type: boolean
            limit:
              description: ''
              default: null
              properties:
                count:
                  description: ''
                  type: number
                foreignTable:
                  description: ''
                  type: string
              type: object
            order:
              description: ''
              default: null
              properties:
                ascending:
                  description: ''
                  type: boolean
                column:
                  description: ''
                  type: string
                foreignTable:
                  description: ''
                  type: string
                nullsFirst:
                  description: ''
                  type: boolean
              type: object
            table:
              description: ''
              default: null
              type: string
          required:
            - auth
            - table
          type: object
      recomputeOnInputChanged: true
    - name: getProductImageUrl
      autoRefresh: true
      fields:
        productId:
          value: null
          connection:
            componentId: j
            path: selectedRow.id
          fieldType: string
          type: connected
        products:
          value: null
          connection:
            componentId: bg_0
            path: result.data
          fieldType: array
          type: connected
      inlineScript:
        content: |
          export async function main(productId: string, products: any[]) {
            return products.find((p) => p.id === productId).image_url;
          }
        language: deno
        path: /getProductImageUrl
        schema:
          $schema: 'https://json-schema.org/draft/2020-12/schema'
          properties:
            productId:
              description: ''
              default: null
              type: string
            products:
              description: ''
              default: null
              items:
                type: string
              type: array
          required:
            - productId
            - products
          type: object
      recomputeOnInputChanged: true
    - name: loadOrders
      autoRefresh: true
      fields:
        auth:
          value: '$res:f/examples/demo_supabase'
          fieldType: object
          format: resource-supabase
          type: static
        columns:
          value: null
          fieldType: string
          type: static
        count:
          value: null
          fieldType: string
          type: static
        filter:
          value: null
          fieldType: object
          type: static
        head:
          value: null
          fieldType: boolean
          type: static
        limit:
          value: null
          fieldType: object
          type: static
        order:
          value: null
          fieldType: object
          type: static
        table:
          value: orders
          fieldType: string
          type: static
      inlineScript:
        content: >
          import { Resource } from
          "https://deno.land/x/windmill@v1.70.1/mod.ts";

          import { createClient } from "https://esm.sh/@supabase/supabase-js@2";





          /**
           * @param count Count algorithm to use to count rows in the table or view.
           * `"exact"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the hood.
           * `"planned"`: Approximated but fast count algorithm. Uses the Postgres statistics under the hood.
           * `"estimated"`: Uses exact count for low numbers and planned count for high numbers.
           *
           * @param head When set to `true`, `data` will not be returned.
           * Useful if you only need the count.
           * 
           * @param filter Learn more at https://supabase.com/docs/reference/javascript/filter
           * 
           * @param order Learn more at https://supabase.com/docs/reference/javascript/order
           * 
           * @param limit Learn more at https://supabase.com/docs/reference/javascript/limit
           */
          export async function main(
            auth: Resource<"supabase">,
            table: string,
            columns?: string,
            count?: "exact" | "planned" | "estimated",
            head?: boolean,
            filter?: {
              column: string;
              operator: string;
              value: any;
            },
            order?: {
              column: string;
              foreignTable: string;
              ascending?: boolean;
              nullsFirst?: boolean;
            },
            limit?: {
              count: number;
              foreignTable?: string;
            },
          ) {
            const client = createClient(auth.url, auth.key);
            const options = (head || count) ? { head, count } : undefined;
            let query = client.from(table).select(columns || undefined, options);
            if (filter?.column) {
              query = query.filter(filter.column, filter.operator, filter.value);
            }
            if (order?.column) {
              const { column, ...options } = order;
              query = query.order(column, options);
            }
            if (limit?.count) {
              const { count, foreignTable } = limit;
              query = query.limit(count, foreignTable ? { foreignTable } : undefined);
            }

            return await query;
          }
        language: deno
        path: /loadOrders
        schema:
          $schema: 'https://json-schema.org/draft/2020-12/schema'
          properties:
            auth:
              default: null
              format: resource-supabase
              type: object
            columns:
              default: null
              type: string
            count:
              default: null
              enum:
                - exact
                - planned
                - estimated
              type: string
            filter:
              default: null
              properties:
                value:
                  type: object
                column:
                  type: string
                operator:
                  type: string
              type: object
            head:
              default: null
              type: boolean
            limit:
              default: null
              properties:
                count:
                  type: number
                foreignTable:
                  type: string
              type: object
            order:
              default: null
              properties:
                ascending:
                  type: boolean
                column:
                  type: string
                foreignTable:
                  type: string
                nullsFirst:
                  type: boolean
              type: object
            table:
              default: null
              type: string
          required:
            - auth
            - table
          type: object
      recomputeOnInputChanged: true
    - name: loadCustomers
      autoRefresh: true
      fields:
        auth:
          value: '$res:f/examples/demo_supabase'
          fieldType: object
          format: resource-supabase
          type: static
        columns:
          value: null
          fieldType: string
          type: static
        count:
          value: null
          fieldType: string
          type: static
        filter:
          value: null
          fieldType: object
          type: static
        head:
          value: null
          fieldType: boolean
          type: static
        limit:
          value: null
          fieldType: object
          type: static
        order:
          value: null
          fieldType: object
          type: static
        table:
          value: customers
          fieldType: string
          type: static
      inlineScript:
        content: >
          import { Resource } from
          "https://deno.land/x/windmill@v1.70.1/mod.ts";

          import { createClient } from "https://esm.sh/@supabase/supabase-js@2";



          /**
           * @param count Count algorithm to use to count rows in the table or view.
           * `"exact"`: Exact but slow count algorithm. Performs a `COUNT(*)` under the hood.
           * `"planned"`: Approximated but fast count algorithm. Uses the Postgres statistics under the hood.
           * `"estimated"`: Uses exact count for low numbers and planned count for high numbers.
           *
           * @param head When set to `true`, `data` will not be returned.
           * Useful if you only need the count.
           * 
           * @param filter Learn more at https://supabase.com/docs/reference/javascript/filter
           * 
           * @param order Learn more at https://supabase.com/docs/reference/javascript/order
           * 
           * @param limit Learn more at https://supabase.com/docs/reference/javascript/limit
           */
          export async function main(
            auth: Resource<"supabase">,
            table: string,
            columns?: string,
            count?: "exact" | "planned" | "estimated",
            head?: boolean,
            filter?: {
              column: string;
              operator: string;
              value: any;
            },
            order?: {
              column: string;
              foreignTable: string;
              ascending?: boolean;
              nullsFirst?: boolean;
            },
            limit?: {
              count: number;
              foreignTable?: string;
            },
          ) {
            const client = createClient(auth.url, auth.key);
            const options = (head || count) ? { head, count } : undefined;
            let query = client.from(table).select(columns || undefined, options);
            if (filter?.column) {
              query = query.filter(filter.column, filter.operator, filter.value);
            }
            if (order?.column) {
              const { column, ...options } = order;
              query = query.order(column, options);
            }
            if (limit?.count) {
              const { count, foreignTable } = limit;
              query = query.limit(count, foreignTable ? { foreignTable } : undefined);
            }

            return await query;
          }
        language: deno
        path: /loadCustomers
        schema:
          $schema: 'https://json-schema.org/draft/2020-12/schema'
          properties:
            auth:
              description: ''
              default: null
              format: resource-supabase
              type: object
            columns:
              description: ''
              default: null
              type: string
            count:
              description: ''
              default: null
              enum:
                - exact
                - planned
                - estimated
              type: string
            filter:
              description: ''
              default: null
              properties:
                value:
                  description: ''
                  type: object
                column:
                  description: ''
                  type: string
                operator:
                  description: ''
                  type: string
              type: object
            head:
              description: ''
              default: null
              type: boolean
            limit:
              description: ''
              default: null
              properties:
                count:
                  description: ''
                  type: number
                foreignTable:
                  description: ''
                  type: string
              type: object
            order:
              description: ''
              default: null
              properties:
                ascending:
                  description: ''
                  type: boolean
                column:
                  description: ''
                  type: string
                foreignTable:
                  description: ''
                  type: string
                nullsFirst:
                  description: ''
                  type: boolean
              type: object
            table:
              description: ''
              default: null
              type: string
          required:
            - auth
            - table
          type: object
      recomputeOnInputChanged: true
    - name: listUser
      autoRefresh: true
      fields:
        users:
          value: null
          connection:
            componentId: bg_3
            path: result.data
          fieldType: array
          type: connected
      inlineScript:
        content: >
          // import * as wmill from
          "https://deno.land/x/windmill@v1.72.0/mod.ts"


          export async function main(users: any[]) {
            return users.map((u) => ({
              label: `${u.first_name}  ${u.last_name}`,
              value: u.id
            }))
          }
        language: deno
        path: /listUser
        schema:
          $schema: 'https://json-schema.org/draft/2020-12/schema'
          properties:
            users:
              description: ''
              default: null
              items:
                type: string
              type: array
          required:
            - users
          type: object
      recomputeOnInputChanged: true
    - name: deleteCart
      autoRefresh: false
      fields: {}
      inlineScript:
        content: 'state.cart = []'
        language: frontend
        path: /deleteCart
      recomputeOnInputChanged: true
  subgrids:
    a-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: true
          h: 1
          id: b
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 10
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: true
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 0
        data:
          card: false
          configuration:
            color:
              value: dark
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonColorOptions
              type: static
            disabled:
              expr: 'false'
              fieldType: boolean
              type: eval
            drawerTitle:
              value: Drawer title
              fieldType: text
              onlyStatic: true
              type: static
            fillContainer:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            label:
              value: Add a new product
              fieldType: text
              type: static
            noPadding:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            size:
              value: xs
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonSizeOptions
              type: static
          horizontalAlignment: right
          id: b
          numberOfSubgrids: 1
          softWrap: true
          type: drawercomponent
          verticalAlignment: center
        id: b
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: true
          h: 19
          id: i
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: true
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 1
          y: 0
        data:
          card: false
          configuration:
            noPadding:
              value: true
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            container:
              class: ''
              style: ''
          id: i
          numberOfSubgrids: 2
          panes:
            - 60
            - 40
          softWrap: true
          type: verticalsplitpanescomponent
        id: i
    a-1:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 20
          id: d
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: false
          configuration:
            noPadding:
              value: true
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            allTabs:
              class: ''
              style: ''
            container:
              class: ''
              style: ''
            selectedTab:
              class: ''
              style: ''
            tabRow:
              class: ''
              style: ''
          id: d
          numberOfSubgrids: 3
          softWrap: true
          tabs:
            - List of orders
            - Analytics
            - Shipping map
          type: tabscomponent
        id: d
    a-2:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 20
          id: aw
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 10
        data:
          card: false
          configuration:
            noPadding:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            container:
              class: ''
              style: ''
          id: aw
          numberOfSubgrids: 2
          panes:
            - 50
            - 50
          softWrap: true
          type: verticalsplitpanescomponent
        id: aw
    a-3:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 20
          id: al
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: false
          configuration:
            noPadding:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            container:
              class: ''
              style: ''
          id: al
          numberOfSubgrids: 2
          panes:
            - 60
            - 40
          softWrap: true
          type: verticalsplitpanescomponent
        id: al
    ab-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 17
          id: ac
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 0
        data:
          actionButtons:
            - card: false
              componentInput:
                fields:
                  auth:
                    value: '$res:u/henri/wm_showcases_supabase'
                    fieldType: object
                    format: resource-supabase
                    type: static
                  orderId:
                    value: ''
                    connection:
                      componentId: ac
                      path: selectedRow.id
                    fieldType: string
                    type: connected
                fieldType: any
                recomputeOnInputChanged: true
                runnable:
                  name: toggleRefund
                  inlineScript:
                    content: >-
                      import { Resource } from
                      "https://deno.land/x/windmill@v1.70.1/mod.ts";

                      import { createClient, SupabaseClient } from
                      "https://esm.sh/@supabase/supabase-js@2.10.0";


                      export async function main(
                        auth: Resource<"supabase">,
                        orderId: string
                      ) {
                        const client = createClient(auth.url, auth.key);

                        const { data } = await client.from('orders').select('refunded').eq('id', orderId);
                        if(data[0]?.refunded) {
                          return `Order with ID "${orderId}" is already refunded`;
                        }

                        const refunded = await setOrderRefundedValue(client, orderId, true);
                        
                        const promises = (refunded.product_ids as string[]).map(id => {
                          return client
                            .from('products')
                            .select('id, quantity')
                            .eq('id', id);
                        });
                        try {
                          const products = await Promise.all(promises);
                          const productValues = [];
                          for(const p of products) {
                            if(p.error) {
                              throw Error(p.error);
                            }
                            const { id, quantity } = p.data[0];
                            productValues.push({ id, quantity });
                          }
                          return await revertProductQuantities(client, productValues);
                        } catch (err: any) {
                          await setOrderRefundedValue(client, orderId, false);
                          throw Error(`Reverted refund because:\n${err}`);
                        }
                      }


                      async function setOrderRefundedValue(client:
                      SupabaseClient<any, "public", any>, id: string, value:
                      boolean) {
                        const { data, error } = await client
                          .from('orders')
                          .update({refunded: value})
                          .eq('id', id)
                          .select();

                        if(error || !data.length) {
                          throw Error(error || `Couldn't find order with ID "${id}"`);
                        }

                        return data[0];
                      }


                      async function revertProductQuantities(client:
                      SupabaseClient<any, "public", any>, products: {id: string,
                      quantity: number}[]) {
                        const promises = products.map(({id, quantity}) => {
                          return client
                            .from('products')
                            .update({quantity: quantity + 1})
                            .eq('id', id)
                            .select();
                        })

                        return await Promise.all(promises);
                      }
                    language: deno
                    path: /toggleRefund
                    schema:
                      $schema: 'https://json-schema.org/draft/2020-12/schema'
                      properties:
                        auth:
                          description: ''
                          default: null
                          format: resource-supabase
                          type: object
                        orderId:
                          description: ''
                          default: null
                          type: string
                      required:
                        - auth
                        - orderId
                      type: object
                  type: runnableByName
                type: runnable
              configuration:
                afterIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                beforeIcon:
                  value: DollarSign
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                color:
                  value: dark
                  fieldType: select
                  optionValuesKey: buttonColorOptions
                  type: static
                disabled:
                  expr: 'false'
                  fieldType: boolean
                  type: eval
                fillContainer:
                  type: static
                goto:
                  value: ''
                  fieldType: text
                  tooltip: Go to an url on success if not empty
                  type: static
                gotoNewTab:
                  value: true
                  fieldType: boolean
                  tooltip: Go to create a new tab
                  type: static
                label:
                  value: Refund
                  fieldType: text
                  type: static
                onSuccess:
                  configuration:
                    '': {}
                  selected: ''
                size:
                  value: xs
                  fieldType: select
                  optionValuesKey: buttonSizeOptions
                  type: static
                triggerOnAppLoad:
                  type: static
              customCss:
                button:
                  class: ''
                  style: ''
              id: ac_a
              recomputeIds:
                - bg_0
                - bg_2
              type: buttoncomponent
            - card: false
              componentInput:
                fields: {}
                fieldType: any
                recomputeOnInputChanged: true
                runnable:
                  name: Inline Script 0
                  inlineScript:
                    content: 'setTab(''a'', 2)'
                    language: frontend
                    path: frontend script
                  type: runnableByName
                type: runnable
              configuration:
                afterIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                beforeIcon:
                  value: User
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                color:
                  value: light
                  fieldType: select
                  optionValuesKey: buttonColorOptions
                  type: static
                disabled:
                  expr: 'false'
                  fieldType: boolean
                  type: eval
                goto:
                  value: ''
                  fieldType: text
                  tooltip: Go to an url on success if not empty
                  type: static
                gotoNewTab:
                  value: true
                  fieldType: boolean
                  tooltip: Go to create a new tab
                  type: static
                label:
                  value: Go to user
                  fieldType: text
                  type: static
                size:
                  value: xs
                  fieldType: select
                  optionValuesKey: buttonSizeOptions
                  type: static
              customCss:
                button:
                  class: ''
                  style: ''
              id: ac_b
              type: buttoncomponent
          card: true
          componentInput:
            value:
              - name: A cell with a long name
                age: 42
                id: 1
              - name: A briefer cell
                age: 84
                id: 2
            fields:
              orders:
                value: null
                connection:
                  componentId: bg_2
                  path: result.data
                fieldType: array
                type: connected
            fieldType: array
            recomputeOnInputChanged: true
            runnable:
              name: selectOrdersColumns
              inlineScript:
                content: |
                  export async function main(orders: any[]) {
                    return orders?.map((order) => {
                      const {  total_price, country, city, address, id } = order;
                      return { id, total_price, address: `${address}, ${city}, ${country}`};
                    });
                  }
                language: deno
                path: /selectOrdersColumns
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    orders:
                      description: ''
                      default: null
                      items:
                        type: string
                      type: array
                  required:
                    - orders
                  type: object
              type: runnableByName
            subFieldType: object
            type: runnable
          configuration:
            pagination:
              configuration:
                '': {}
              selected: ''
            search:
              value: By Component
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: ac
          type: tablecomponent
        id: ac
    ab-1:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 17
          id: ad
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: false
          configuration:
            noPadding:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            container:
              class: m-2
              style: ''
          id: ad
          numberOfSubgrids: 1
          softWrap: true
          type: containercomponent
        id: ad
    ad-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: af
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 10
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Order items
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: af
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: af
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 15
          id: ae
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 0
        data:
          actionButtons:
            - card: false
              componentInput:
                fields: {}
                fieldType: any
                recomputeOnInputChanged: true
                runnable:
                  name: Inline Script 0
                  inlineScript:
                    content: 'setTab(''a'', 0)'
                    language: frontend
                    path: frontend script
                  type: runnableByName
                type: runnable
              configuration:
                afterIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                beforeIcon:
                  value: ArrowUpRight
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                color:
                  value: dark
                  fieldType: select
                  optionValuesKey: buttonColorOptions
                  type: static
                disabled:
                  expr: 'false'
                  fieldType: boolean
                  type: eval
                goto:
                  value: ''
                  fieldType: text
                  tooltip: Go to an url on success if not empty
                  type: static
                gotoNewTab:
                  value: true
                  fieldType: boolean
                  tooltip: Go to create a new tab
                  type: static
                label:
                  value: Go to product
                  fieldType: text
                  type: static
                size:
                  value: xs
                  fieldType: select
                  optionValuesKey: buttonSizeOptions
                  type: static
              customCss:
                button:
                  class: ''
                  style: ''
              id: ae_a
              type: buttoncomponent
          card: true
          componentInput:
            value:
              - name: A cell with a long name
                age: 42
                id: 1
              - name: A briefer cell
                age: 84
                id: 2
            fields:
              orders:
                value: null
                connection:
                  componentId: bg_2
                  path: result.data
                fieldType: array
                type: connected
              products:
                value: null
                connection:
                  componentId: bg_0
                  path: result.data
                fieldType: array
                type: connected
              selectedOrderIndex:
                value: null
                connection:
                  componentId: ac
                  path: selectedRowIndex
                fieldType: number
                type: connected
            fieldType: array
            recomputeOnInputChanged: true
            runnable:
              name: getOrderProducts
              inlineScript:
                content: >
                  // import * as wmill from
                  "https://deno.land/x/windmill@v1.72.0/mod.ts"


                  export async function main(
                    selectedOrderIndex: number,
                    orders: any[],
                    products: any[],
                  ) {
                    if (!orders) {
                      return [];
                    }

                    return orders[selectedOrderIndex].product_ids.map((id) => {
                      const product = products?.find((p) => p.id === id);

                      if (!product) {
                        return {};
                      }

                      const { title, description, price } = product;

                      return { title, description, price, quantity: 1 };
                    });
                  }
                language: deno
                path: /getOrderProducts
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    orders:
                      default: null
                      items:
                        type: string
                      type: array
                    products:
                      default: null
                      items:
                        type: string
                      type: array
                    selectedOrderIndex:
                      default: null
                      type: number
                  required:
                    - selectedOrderIndex
                    - orders
                    - products
                  type: object
              type: runnableByName
            subFieldType: object
            type: runnable
          configuration:
            pagination:
              configuration:
                '': {}
              selected: ''
            search:
              value: Disabled
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: ae
          type: tablecomponent
        id: ae
    al-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: an
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 2
          y: 0
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Select a user
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
            tooltip:
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: an
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: an
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: am
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: false
          configuration:
            create:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            defaultValue:
              fieldType: object
              type: static
            items:
              value:
                - value: foo
                  label: Foo
                - value: bar
                  label: Bar
              connection:
                componentId: bg_4
                path: result
              fieldType: array
              subFieldType: object
              type: connected
            placeholder:
              value: Select an item
              fieldType: text
              onlyStatic: true
              type: static
          customCss:
            input:
              style: ''
          id: am
          softWrap: true
          type: selectcomponent
          verticalAlignment: center
        id: am
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 17
          id: ao
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 2
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 1
        data:
          actionButtons:
            - card: false
              componentInput:
                fields: {}
                fieldType: any
                recomputeOnInputChanged: true
                runnable:
                  name: addToCart
                  inlineScript:
                    content: |

                      if (state.cart) {
                        state.cart = [ao.selectedRow.id, ...state.cart]
                      } else {
                        state.cart = [ao.selectedRow.id]
                      }
                    language: frontend
                    path: /addToCart
                  type: runnableByName
                type: runnable
              configuration:
                afterIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                beforeIcon:
                  value: PlusCircle
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                color:
                  value: blue
                  fieldType: select
                  optionValuesKey: buttonColorOptions
                  type: static
                disabled:
                  expr: 'false'
                  fieldType: boolean
                  type: eval
                fillContainer:
                  type: static
                goto:
                  value: ''
                  fieldType: text
                  tooltip: Go to an url on success if not empty
                  type: static
                gotoNewTab:
                  value: true
                  fieldType: boolean
                  tooltip: Go to create a new tab
                  type: static
                label:
                  value: Add
                  fieldType: text
                  type: static
                onSuccess:
                  configuration:
                    '': {}
                  selected: ''
                size:
                  value: xs
                  fieldType: select
                  optionValuesKey: buttonSizeOptions
                  type: static
                triggerOnAppLoad:
                  type: static
              customCss:
                button:
                  class: ''
                  style: ''
              id: ao_a
              recomputeIds:
                - ap
              type: buttoncomponent
          card: true
          componentInput:
            value:
              - name: A cell with a long name
                age: 42
                id: 1
              - name: A briefer cell
                age: 84
                id: 2
            connection:
              componentId: j
              path: result
            fieldType: array
            subFieldType: object
            type: connected
          configuration:
            search:
              value: By Component
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: ao
          type: tablecomponent
        id: ao
    al-1:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: aq
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 10
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Cart
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: aq
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: aq
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 14
          id: ap
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 0
        data:
          actionButtons:
            - card: false
              componentInput:
                fields: {}
                fieldType: any
                recomputeOnInputChanged: true
                runnable:
                  name: Inline Script 0
                  inlineScript:
                    content: |-
                      if (state.cart) {
                        state.cart.splice(ap.selectedRowIndex, 1)
                      }
                    language: frontend
                    path: frontend script
                  type: runnableByName
                type: runnable
              configuration:
                afterIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                beforeIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                color:
                  value: red
                  fieldType: select
                  optionValuesKey: buttonColorOptions
                  type: static
                disabled:
                  expr: 'false'
                  fieldType: boolean
                  type: eval
                goto:
                  value: ''
                  fieldType: text
                  tooltip: Go to an url on success if not empty
                  type: static
                gotoNewTab:
                  value: true
                  fieldType: boolean
                  tooltip: Go to create a new tab
                  type: static
                label:
                  value: Remove
                  fieldType: text
                  type: static
                size:
                  value: xs
                  fieldType: select
                  optionValuesKey: buttonSizeOptions
                  type: static
              customCss:
                button:
                  class: ''
                  style: ''
              id: ap_a
              recomputeIds:
                - ap
              type: buttoncomponent
          card: true
          componentInput:
            value:
              - name: A cell with a long name
                age: 42
                id: 1
              - name: A briefer cell
                age: 84
                id: 2
            fields: {}
            fieldType: array
            recomputeOnInputChanged: true
            runnable:
              name: loadCartFromState
              inlineScript:
                content: >-

                  return state.cart ? state.cart.map(id => j.result.find(x =>
                  x.id === id)) : []
                language: frontend
                path: /loadCartFromState
              type: runnableByName
            subFieldType: object
            type: runnable
          configuration:
            pagination:
              configuration:
                '': {}
              selected: ''
            search:
              value: Disabled
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: ap
          type: tablecomponent
        id: ap
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: ba
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 15
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 12
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: >-
              Total: ${ap.result.reduce((accu, curr) => accu + curr.price/100,
              0)} CHF
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: right
          id: ba
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: ba
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: at
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 18
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 11
        data:
          card: false
          componentInput:
            fields: {}
            fieldType: any
            recomputeOnInputChanged: true
            runnable:
              name: Inline Script 0
              inlineScript:
                content: 'state.cart = []'
                language: frontend
                path: /Inline Script 0
              type: runnableByName
            type: runnable
          configuration:
            afterIcon:
              fieldType: icon-select
              onlyStatic: true
              type: static
            beforeIcon:
              value: Trash
              fieldType: icon-select
              onlyStatic: true
              type: static
            color:
              value: red
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonColorOptions
              type: static
            disabled:
              expr: 'false'
              fieldType: boolean
              type: eval
            fillContainer:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            goto:
              value: ''
              fieldType: text
              tooltip: Go to an url on success if not empty
              type: static
            gotoNewTab:
              value: true
              fieldType: boolean
              tooltip: Go to create a new tab
              type: static
            label:
              value: Delete cart
              fieldType: text
              type: static
            onSuccess:
              configuration:
                '': {}
              selected: ''
            size:
              value: xs
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonSizeOptions
              type: static
            triggerOnAppLoad:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            button:
              class: ''
              style: ''
          horizontalAlignment: left
          id: at
          recomputeIds:
            - ap
          softWrap: true
          type: buttoncomponent
          verticalAlignment: center
        id: at
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: ar
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 5
          x: 7
          y: 18
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 1
          y: 10
        data:
          card: false
          componentInput:
            fields:
              auth:
                value: '$res:f/examples/demo_supabase'
                fieldType: object
                format: resource-supabase
                type: static
              customerId:
                value: null
                connection:
                  componentId: am
                  path: result
                fieldType: string
                type: connected
              productIds:
                value: []
                connection:
                  componentId: state
                  path: cart
                fieldType: array
                type: connected
            fieldType: any
            recomputeOnInputChanged: true
            runnable:
              name: checkout
              inlineScript:
                content: >-
                  import { Resource } from
                  "https://deno.land/x/windmill@v1.70.1/mod.ts";

                  import {
                    createClient,
                    SupabaseClient,
                  } from "https://esm.sh/@supabase/supabase-js@2.10.0";


                  export async function main(
                    auth: Resource<"supabase">,
                    customerId: string,
                    productIds: string[],
                  ) {
                    const client = createClient(auth.url, auth.key);

                    productIds = productIds.filter(Boolean);
                    const { country, city, address } = await getCustomer(client, customerId);
                    const total_price = await getTotalPrice(client, productIds);

                    return await client.from("orders").insert({
                      customer_id: customerId,
                      product_ids: productIds,
                      country,
                      city,
                      address,
                      total_price,
                    }).select();
                  }


                  async function getCustomer(client: SupabaseClient, id: string)
                  {
                    const { data, error } = await client.from("customers").select(
                      "country, city, address",
                    ).eq("id", id);

                    if (error || !data.length) {
                      throw Error(error?.message || `Couldn't find customer with ID "${id}"`);
                    }

                    return data[0];
                  }


                  async function getTotalPrice(client: SupabaseClient, ids:
                  string[]) {
                    const promises = ids.map((id) =>
                      client.from("products").select("price").eq("id", id)
                    );
                    const res = await Promise.all(promises);
                    let total = 0;

                    for (let i = 0; i < res.length; i++) {
                      const { data, error } = res[i];
                      if (error || !data.length) {
                        throw Error(
                          error?.message || `Couldn't find product with ID "${ids[i]}"`,
                        );
                      }
                      total += data[0].price;
                    }

                    return total;
                  }
                language: deno
                path: /checkout
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    auth:
                      description: ''
                      default: null
                      format: resource-supabase
                      type: object
                    customerId:
                      description: ''
                      default: null
                      type: string
                    productIds:
                      description: ''
                      default: null
                      items:
                        type: string
                      type: array
                  required:
                    - auth
                    - customerId
                    - productIds
                  type: object
              type: runnableByName
            type: runnable
          configuration:
            afterIcon:
              fieldType: icon-select
              onlyStatic: true
              type: static
            beforeIcon:
              value: ArrowRight
              fieldType: icon-select
              onlyStatic: true
              type: static
            color:
              value: dark
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonColorOptions
              type: static
            disabled:
              expr: state.cart?.length === 0
              fieldType: boolean
              type: eval
            fillContainer:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            goto:
              value: ''
              fieldType: text
              tooltip: Go to an url on success if not empty
              type: static
            gotoNewTab:
              value: true
              fieldType: boolean
              tooltip: Go to create a new tab
              type: static
            label:
              value: Checkout
              fieldType: text
              type: static
            onSuccess:
              configuration:
                '': {}
              selected: ''
            size:
              value: xs
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonSizeOptions
              type: static
            triggerOnAppLoad:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            button:
              class: ''
              style: ''
          horizontalAlignment: right
          id: ar
          recomputeIds:
            - bg_6
            - bg_5
          softWrap: true
          type: buttoncomponent
          verticalAlignment: center
        id: ar
    aw-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 19
          id: aj
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 0
        data:
          actionButtons: []
          card: true
          componentInput:
            value:
              - name: A cell with a long name
                age: 42
                id: 1
              - name: A briefer cell
                age: 84
                id: 2
            connection:
              componentId: bg_3
              path: result.data
            fieldType: array
            subFieldType: object
            type: connected
          configuration:
            search:
              value: By Component
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: aj
          type: tablecomponent
        id: aj
    aw-1:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: ay
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 10
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: >-
              Orders of ${aj.selectedRow.first_name}
              ${aj.selectedRow.last_name} 
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: ay
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: ay
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 18
          id: ax
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 0
        data:
          actionButtons:
            - card: false
              componentInput:
                fields: {}
                fieldType: any
                recomputeOnInputChanged: true
                runnable:
                  name: Inline Script 0
                  inlineScript:
                    content: 'setTab(''a'', 1)'
                    language: frontend
                    path: frontend script
                  type: runnableByName
                type: runnable
              configuration:
                afterIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                beforeIcon:
                  fieldType: icon-select
                  onlyStatic: true
                  type: static
                color:
                  value: dark
                  fieldType: select
                  optionValuesKey: buttonColorOptions
                  type: static
                disabled:
                  expr: 'false'
                  fieldType: boolean
                  type: eval
                goto:
                  value: ''
                  fieldType: text
                  tooltip: Go to an url on success if not empty
                  type: static
                gotoNewTab:
                  value: true
                  fieldType: boolean
                  tooltip: Go to create a new tab
                  type: static
                label:
                  value: Go to order
                  fieldType: text
                  type: static
                size:
                  value: xs
                  fieldType: select
                  optionValuesKey: buttonSizeOptions
                  type: static
              customCss:
                button:
                  class: ''
                  style: ''
              id: ax_a
              type: buttoncomponent
          card: true
          componentInput:
            value:
              - name: A cell with a long name
                age: 42
                id: 1
              - name: A briefer cell
                age: 84
                id: 2
            fields:
              auth:
                value: '$res:f/examples/demo_supabase'
                fieldType: object
                format: resource-supabase
                type: static
              customerId:
                value: null
                connection:
                  componentId: aj
                  path: selectedRow.id
                fieldType: string
                type: connected
            fieldType: array
            recomputeOnInputChanged: true
            runnable:
              name: loadOrderByCustomer
              inlineScript:
                content: >
                  import { Resource } from
                  "https://deno.land/x/windmill@v1.70.1/mod.ts";

                  import { createClient } from
                  "https://esm.sh/@supabase/supabase-js@2";


                  export async function main(
                    auth: Resource<"supabase">,
                    customerId: string
                  ) {
                    const client = createClient(auth.url, auth.key);
                    let query = client.from('orders').select().eq("customer_id", customerId)

                    const response = await query;

                    return response.data.map(x => ({ id: x.id }))

                  }
                language: deno
                path: /loadOrderByCustomer
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    auth:
                      description: ''
                      default: null
                      format: resource-supabase
                      type: object
                    customerId:
                      description: ''
                      default: null
                      type: string
                  required:
                    - auth
                    - customerId
                  type: object
              type: runnableByName
            subFieldType: object
            type: runnable
          configuration:
            pagination:
              configuration:
                '': {}
              selected: ''
            search:
              value: Disabled
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: ax
          type: tablecomponent
        id: ax
    b-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: s
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 0
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Name
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: s
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: s
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: t
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 1
          y: 0
        data:
          card: false
          configuration:
            defaultValue:
              fieldType: text
              type: static
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: t
          softWrap: true
          type: textinputcomponent
          verticalAlignment: center
        id: t
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: v
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 2
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 5
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Description
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: v
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: v
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: w
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 3
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 1
          y: 5
        data:
          card: false
          configuration:
            defaultValue:
              fieldType: text
              type: static
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: w
          softWrap: true
          type: textinputcomponent
          verticalAlignment: center
        id: w
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: x
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 4
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 6
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Quantity
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: x
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: x
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: y
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 5
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 1
          y: 6
        data:
          card: false
          configuration:
            defaultValue:
              value: 1
              fieldType: number
              type: static
            max:
              fieldType: number
              type: static
            min:
              value: 0
              fieldType: number
              type: static
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
            step:
              value: 1
              fieldType: number
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: y
          softWrap: true
          type: numberinputcomponent
          verticalAlignment: center
        id: y
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: z
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 6
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 7
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Image
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: z
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: z
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 6
          id: u
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 7
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 4
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 1
        data:
          card: false
          configuration:
            acceptedFileTypes:
              value:
                - image/*
                - application/pdf
              fieldType: array
              onlyStatic: true
              type: static
            allowMultiple:
              value: false
              fieldType: boolean
              onlyStatic: true
              tooltip: 'If allowed, the user will be able to select more than one file'
              type: static
            text:
              value: Drag and drop files or click to select them
              fieldType: text
              onlyStatic: true
              type: static
          customCss:
            container:
              class: ''
              style: ''
          id: u
          type: fileinputcomponent
        id: u
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 2
          id: aa
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 9
          y: 14
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 1
          y: 7
        data:
          card: false
          componentInput:
            fields: {}
            fieldType: any
            type: runnable
          configuration:
            afterIcon:
              fieldType: icon-select
              onlyStatic: true
              type: static
            beforeIcon:
              value: Plus
              fieldType: icon-select
              onlyStatic: true
              type: static
            color:
              value: gray
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonColorOptions
              type: static
            disabled:
              expr: 'false'
              fieldType: boolean
              type: eval
            fillContainer:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            goto:
              value: ''
              fieldType: text
              tooltip: Go to an url on success if not empty
              type: static
            gotoNewTab:
              value: true
              fieldType: boolean
              tooltip: Go to create a new tab
              type: static
            label:
              value: Create product
              fieldType: text
              type: static
            onSuccess:
              configuration:
                '': {}
              selected: ''
            size:
              value: sm
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonSizeOptions
              type: static
            triggerOnAppLoad:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            button:
              class: ''
              style: ''
          horizontalAlignment: center
          id: aa
          softWrap: true
          type: buttoncomponent
          verticalAlignment: center
        id: aa
    d-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 18
          id: ab
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: false
          configuration:
            noPadding:
              value: true
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            container:
              class: ''
              style: ''
          id: ab
          numberOfSubgrids: 2
          panes:
            - 60
            - 40
          softWrap: true
          type: verticalsplitpanescomponent
        id: ab
    d-1:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 7
          id: e
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 5
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 8
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: true
          componentInput:
            value:
              data:
                - 25
                - 50
                - 25
              labels:
                - Pie
                - Charts
                - <3
            fields:
              orders:
                value: null
                connection:
                  componentId: bg_2
                  path: result.data
                fieldType: array
                type: connected
            fieldType: object
            recomputeOnInputChanged: true
            runnable:
              name: pieChartData
              inlineScript:
                content: |
                  export async function main(orders: any[]) {
                    let one = 0;
                    let two = 0;
                    let more = 0;

                    orders.forEach((o) => {
                      if (o.product_ids.length === 1) {
                        one++;
                      } else if (o.product_ids.length === 2) {
                        two++;
                      } else {
                        more++;
                      }
                    });

                    return {
                      "data": [
                        one,
                        two,
                        more,
                      ],
                      "labels": [
                        "1 item",
                        "2 items",
                        "More than 2 items",
                      ],
                    };
                  }
                language: deno
                path: /pieChartData
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    orders:
                      description: ''
                      default: null
                      items:
                        type: string
                      type: array
                  required:
                    - orders
                  type: object
              type: runnableByName
            type: runnable
          configuration:
            doughnutStyle:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            theme:
              value: theme2
              fieldType: select
              onlyStatic: true
              optionValuesKey: chartThemeOptions
              type: static
          customCss:
            container:
              class: ''
              style: ''
          id: e
          type: piechartcomponent
        id: e
    d-2:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          id: bb
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 6
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 1
        data:
          card: false
          configuration:
            latitude:
              value: 50
              fieldType: number
              type: static
            longitude:
              value: 15
              fieldType: number
              type: static
            markers:
              value:
                - color: '#dc2626'
                  lat: 41.902783
                  lon: 12.496366
                  radius: 7
                  strokeColor: '#fca5a5'
                  strokeWidth: 3
                  title: Rome
                - lat: 51.507359
                  lon: -0.136439
                  title: London
              fieldType: array
              fileUpload:
                accept: application/json
                convertTo: text
              subFieldType: object
              type: static
            zoom:
              value: 3
              fieldType: number
              type: static
          customCss:
            map:
              class: ''
              style: ''
          id: bb
          type: mapcomponent
        id: bb
    i-0:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 18
          id: j
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 10
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 0
        data:
          actionButtons: []
          card: true
          componentInput:
            value:
              - description: The latest smartphone from Apple
                price: 999
                quantity: 50
                title: iPhone 13
            connection:
              componentId: bg_0
              path: result.data
            fields:
              products:
                value: null
                connection:
                  componentId: bg_0
                  path: result.data
                fieldType: array
                type: connected
            fieldType: array
            recomputeOnInputChanged: true
            runnable:
              name: selectProductColumns
              inlineScript:
                content: |
                  export async function main(products: any[]) {
                    return products?.map((product) => {
                      const { id, title, description, price, quantity } = product;
                      return { id, title, description, price, quantity };
                    });
                  }
                language: deno
                path: /selectProductColumns
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    products:
                      description: ''
                      default: null
                      items:
                        type: string
                      type: array
                  required:
                    - products
                  type: object
              type: runnableByName
            subFieldType: object
            type: runnable
          configuration:
            pagination:
              configuration:
                '': {}
              selected: ''
            search:
              value: By Component
              fieldType: select
              onlyStatic: true
              optionValuesKey: tableSearchOptions
              type: static
          customCss:
            container:
              class: 'capitalize '
              style: ''
            tableBody:
              class: ''
              style: ''
            tableFooter:
              class: ''
              style: ''
            tableHeader:
              class: ''
              style: ''
          id: j
          type: tablecomponent
        id: j
    i-1:
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: m
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 0
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 1
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Name
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: m
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: m
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: n
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 1
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 1
          y: 1
        data:
          card: false
          configuration:
            defaultValue:
              connection:
                componentId: j
                path: selectedRow.title
              fieldType: text
              type: connected
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: n
          softWrap: true
          type: textinputcomponent
          verticalAlignment: center
        id: n
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: o
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 2
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 2
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Description
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: o
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: o
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: p
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 3
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 1
          y: 2
        data:
          card: false
          configuration:
            defaultValue:
              connection:
                componentId: j
                path: selectedRow.description
              fieldType: text
              type: connected
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: p
          softWrap: true
          type: textinputcomponent
          verticalAlignment: center
        id: p
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: l
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 4
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 2
          y: 0
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Quantity
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: l
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: l
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: k
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 5
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 0
        data:
          card: false
          configuration:
            defaultValue:
              connection:
                componentId: j
                path: selectedRow.quantity
              fieldType: number
              type: connected
            max:
              fieldType: number
              type: static
            min:
              fieldType: number
              type: static
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
            step:
              value: 1
              fieldType: number
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: k
          softWrap: true
          type: numberinputcomponent
          verticalAlignment: center
        id: k
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: au
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 6
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 1
          y: 3
        data:
          card: false
          componentInput:
            value: 'Hello ${ctx.username}'
            eval: Price
            fieldType: template
            type: template
          configuration:
            copyButton:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
            style:
              value: Label
              fieldType: select
              onlyStatic: true
              optionValuesKey: textStyleOptions
              type: static
          customCss:
            text:
              class: ''
              style: ''
          horizontalAlignment: left
          id: au
          softWrap: false
          type: textcomponent
          verticalAlignment: center
        id: au
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: av
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 7
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 2
          x: 0
          y: 8
        data:
          card: false
          configuration:
            defaultValue:
              connection:
                componentId: j
                path: selectedRow.price
              fieldType: number
              type: connected
            max:
              fieldType: number
              type: static
            min:
              fieldType: number
              type: static
            placeholder:
              value: Type...
              fieldType: text
              onlyStatic: true
              type: static
            step:
              value: 1
              fieldType: number
              type: static
          customCss:
            input:
              class: ''
              style: ''
          id: av
          softWrap: true
          type: numberinputcomponent
          verticalAlignment: center
        id: av
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 6
          id: r
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 8
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 4
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 3
          x: 0
          y: 4
        data:
          card: false
          configuration:
            altText:
              value: ''
              fieldType: text
              onlyStatic: true
              tooltip: >-
                This text will appear if the image can't be loaded for any
                reason
              type: static
            imageFit:
              value: contain
              fieldType: select
              onlyStatic: true
              optionValuesKey: objectFitOptions
              type: static
            source:
              value: /logo.svg
              connection:
                componentId: bg_1
                path: result
              fieldType: text
              fileUpload:
                accept: image/*
                convertTo: base64
              type: connected
          customCss:
            image:
              class: ''
              style: ''
          id: r
          type: imagecomponent
        id: r
      - '12':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          id: q
          max:
            h: 100
            w: 12
          min:
            h: 1
            w: 1
          resizable: true
          w: 12
          x: 0
          y: 17
        '3':
          customDragger: false
          customResizer: false
          draggable: true
          fixed: false
          h: 1
          max:
            h: 100
            w: 3
          min:
            h: 1
            w: 1
          resizable: true
          w: 1
          x: 0
          y: 3
        data:
          card: false
          componentInput:
            fields:
              description:
                value: null
                connection:
                  componentId: p
                  path: result
                fieldType: string
                type: connected
              auth:
                value: '$res:f/examples/demo_supabase'
                fieldType: object
                format: resource-supabase
                type: static
              id:
                value: null
                connection:
                  componentId: j
                  path: selectedRow.id
                fieldType: string
                type: connected
              price:
                value: null
                connection:
                  componentId: av
                  path: result
                fieldType: number
                type: connected
              quantity:
                value: null
                connection:
                  componentId: k
                  path: result
                fieldType: number
                type: connected
              title:
                value: null
                connection:
                  componentId: n
                  path: result
                fieldType: string
                type: connected
            fieldType: any
            recomputeOnInputChanged: true
            runnable:
              name: updateProduct
              inlineScript:
                content: >
                  import { Resource } from
                  "https://deno.land/x/windmill@v1.70.1/mod.ts";

                  import { createClient } from
                  "https://esm.sh/@supabase/supabase-js@2";


                  export async function main(
                    auth: Resource<"supabase">,
                    id: string,
                    title: string,
                    description: string,
                    quantity: number,
                    price: number,
                  ) {
                    const client = createClient(auth.url, auth.key);

                    return await client
                      .from("products")
                      .update({ title, description, quantity, price })
                      .eq("id", id);
                  }
                language: deno
                path: hub/648/supabase/update_data
                schema:
                  $schema: 'https://json-schema.org/draft/2020-12/schema'
                  properties:
                    description:
                      description: ''
                      default: null
                      type: string
                    auth:
                      description: ''
                      default: null
                      format: resource-supabase
                      type: object
                    id:
                      description: ''
                      default: null
                      type: string
                    price:
                      description: ''
                      default: null
                      type: number
                    quantity:
                      description: ''
                      default: null
                      type: number
                    title:
                      description: ''
                      default: null
                      type: string
                  required:
                    - auth
                    - id
                    - title
                    - description
                    - quantity
                    - price
                  type: object
              type: runnableByName
            type: runnable
          configuration:
            afterIcon:
              fieldType: icon-select
              onlyStatic: true
              type: static
            beforeIcon:
              value: Save
              fieldType: icon-select
              onlyStatic: true
              type: static
            color:
              value: dark
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonColorOptions
              type: static
            disabled:
              expr: 'false'
              fieldType: boolean
              type: eval
            fillContainer:
              value: true
              fieldType: boolean
              onlyStatic: true
              type: static
            goto:
              value: ''
              fieldType: text
              tooltip: Go to an url on success if not empty
              type: static
            gotoNewTab:
              value: true
              fieldType: boolean
              tooltip: Go to create a new tab
              type: static
            label:
              value: Save
              fieldType: text
              type: static
            size:
              value: xs
              fieldType: select
              onlyStatic: true
              optionValuesKey: buttonSizeOptions
              type: static
            triggerOnAppLoad:
              value: false
              fieldType: boolean
              onlyStatic: true
              type: static
          customCss:
            button:
              class: ''
              style: ''
          horizontalAlignment: right
          id: q
          recomputeIds:
            - bg_0
          softWrap: true
          type: buttoncomponent
          verticalAlignment: center
        id: q
  unusedInlineScripts: []
policy:
  execution_mode: publisher
  on_behalf_of: u/henri
  on_behalf_of_email: henri@windmill.dev
  triggerables:
    rawscript/0fc9afb3c876f0393da742d9e43c29bbd011397034da32caa19cdb7f4e069b4c:
      auth: '$res:f/examples/demo_supabase'
      columns: null
      count: null
      filter: null
      head: null
      limit: null
      order: null
      table: orders
    rawscript/1f7dc8e50201accc47245ae1f132d1b87f121ee9b3efe63ec86b5acf11023a44:
      auth: '$res:f/examples/demo_supabase'
    rawscript/2238f7d181f880a1b25230c793a932ef5b5b3b344214525ad02fdef6b69dbcdb: {}
    rawscript/287e1830e0eb847eb3e34e58a108a2ecd5be63c913ecbb5e5b17a5c847c10e70: {}
    rawscript/2b333c674ec5a18caec9d0a59a2b1afb78df48ad8a11576d3ecacd13502d86a2:
      auth: '$res:f/examples/demo_supabase'
      columns: null
      count: null
      filter: null
      head: null
      limit: null
      order: null
      table: products
    rawscript/301478c282cd0dfe4633a60267fd25a6f317cdf1ccac5145ed2b4d34a4d83936: {}
    rawscript/46f722936f8afa7858453ed0c4cb21e7def702d455f5f1957d3b9a366da2421e: {}
    rawscript/4aa1edb0ca2e107d16b060709218c6a2e4028e8b8f25be3a42d1087cd9a37b17: {}
    rawscript/4daeb0c09a282117d2aee2db4a89ac2f18c51d9d51477e78ac3df086ffd9d962:
      auth: '$res:f/examples/demo_supabase'
      columns: null
      count: null
      filter: null
      head: null
      limit: null
      order: null
      table: customers
    rawscript/79254a6b92a44dbd31b4e38c4a33b983997ed33f353275581a3cc97aaa64599c: {}
    rawscript/7aa4c201af40e54bb24a1a3c4ff46c63431dad32b4bd28fc5039bf2e823b42b7:
      auth: '$res:u/henri/wm_showcases_supabase'
    rawscript/8bbe6a0146ba935a6ce17ea427a8391452345ce6a63c39589ca0979a65de7ed0: {}
    rawscript/8e456100f65e6a4a135a74532f63d52c12d46cde68a8a4e965c1937beb24ee40: {}
    rawscript/9a3f132bdfe05c1fb51c7e77e798100b76ed33cc801d82f24198057562a248e8: {}
    rawscript/b45a10d5c6ba38f72c716b43ad04e0d6c3eaac672148b5bcfc75b593b25e6a54: {}
    rawscript/be54fbbaee55accca6fb7f362e19e82d36536d314c0f784c66e82a48e56a9cb2:
      auth: '$res:f/examples/demo_supabase'
    rawscript/c2d55b8bd906c097307308c26c3962a0cbe8cc96343b3dfb6b8d7f58f9f9972e: {}
    rawscript/c9cb4c4f884d998812923cdfb7ee1a20ff6e2b20068a329589e5f4184fe08350: {}
    rawscript/cfddc2cdc871fc011b37a6aebda250d0cf05b996829fdd1fa741490b668d4448:
      auth: '$res:f/examples/demo_supabase'
    rawscript/fa14df9c0bc7be852550ebe01996be628ccf535c6e8ac6f57dae2f45518f6e9a: {}
